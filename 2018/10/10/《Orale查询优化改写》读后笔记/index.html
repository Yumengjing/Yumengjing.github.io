<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="平凡人做平凡事"><title>《Orale查询优化改》读后笔记 | 羽梦涟漪</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">《Orale查询优化改》读后笔记</h1><a id="logo" href="/.">羽梦涟漪</a><p class="description">羽梦的博客</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">《Orale查询优化改》读后笔记</h1><div class="post-meta">Oct 10, 2018<span> | </span><span class="category"><a href="/categories/数据库/">数据库</a></span></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><!-- span.post-meta-item-text= " 字数统计："--><span class="post-count"> 3.9k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><!-- span.post-meta-item-text= " 阅读时长："--><span class="post-count"> 18</span><span class="post-meta-item-text"> 分钟</span></span></span><div class="post-content"><h3 id="第一章单表查询："><a href="#第一章单表查询：" class="headerlink" title="第一章单表查询："></a>第一章单表查询：</h3><h4 id="1-3-查找空值-和-null对于不同的函数起不同作用"><a href="#1-3-查找空值-和-null对于不同的函数起不同作用" class="headerlink" title="1.3 查找空值 和 null对于不同的函数起不同作用"></a>1.3 查找空值 和 null对于不同的函数起不同作用</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">replace</span>(<span class="string">'strng'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>)	<span class="comment">--在string查找a,然后用b替换</span></span><br><span class="line"><span class="keyword">greatest</span>(<span class="string">'a'</span>,<span class="string">'b'</span>) <span class="comment">--返回最大值，其中字符串和数值比较各有不同，当数和字符串比较会提示错误</span></span><br></pre></td></tr></table></figure>
<h4 id="1-4-将空值转换为实际值"><a href="#1-4-将空值转换为实际值" class="headerlink" title="1.4 将空值转换为实际值"></a>1.4 将空值转换为实际值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">coalesce 和 nvl ，获取第一个不为空的值，其中coalesce支持多个参数，比nvl更好</span><br><span class="line">coalesce('','','','') 	<span class="comment">--同时多个参数</span></span><br><span class="line">nvl(nvl('',''),'')		<span class="comment">--多层嵌套，每次只能比较两个数值</span></span><br></pre></td></tr></table></figure>
<h4 id="1-7-为列名取有意义的名称"><a href="#1-7-为列名取有意义的名称" class="headerlink" title="1.7.为列名取有意义的名称"></a>1.7.为列名取有意义的名称</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  A <span class="keyword">as</span> B <span class="keyword">from</span> <span class="keyword">table</span>; </span><br><span class="line"><span class="keyword">select</span> A B <span class="keyword">from</span> <span class="keyword">table</span>; </span><br><span class="line">上述两个意思一样，将A列名改为B</span><br></pre></td></tr></table></figure>
<h4 id="1-8-在where-子句中引用取别名的列-需要嵌套一层select"><a href="#1-8-在where-子句中引用取别名的列-需要嵌套一层select" class="headerlink" title="1.8 在where 子句中引用取别名的列,需要嵌套一层select"></a>1.8 在where 子句中引用取别名的列,需要嵌套一层select</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> *  <span class="keyword">from</span> (<span class="keyword">select</span> A <span class="keyword">as</span> B <span class="keyword">from</span> <span class="keyword">table</span>) <span class="keyword">where</span> B = <span class="string">"b"</span></span><br></pre></td></tr></table></figure>
<h4 id="1-9-拼接列-双竖杆为拼接符号"><a href="#1-9-拼接列-双竖杆为拼接符号" class="headerlink" title="1.9 拼接列 || 双竖杆为拼接符号"></a>1.9 拼接列 || 双竖杆为拼接符号</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> A||<span class="string">'的父亲是'</span>||B   <span class="keyword">as</span> C  <span class="keyword">from</span> <span class="keyword">table</span>；</span><br><span class="line">结果：</span><br><span class="line">C</span><br><span class="line"><span class="comment">---------------------</span></span><br><span class="line">A的父亲是B</span><br><span class="line">用来拼接<span class="keyword">SQL</span>,用于直接用基础数据或者数据字典来批量生产，进行修改</span><br><span class="line"><span class="keyword">select</span> ‘<span class="keyword">truncate</span> <span class="keyword">table</span> ’ || <span class="string">' owner '</span> || <span class="string">'.'</span> || table_name || <span class="string">';'</span> <span class="keyword">as</span> 清空表</span><br><span class="line"><span class="keyword">from</span> all_tables </span><br><span class="line"><span class="keyword">where</span> owner = <span class="string">'scott'</span>;</span><br><span class="line"><span class="comment">--将会对用户为scott拥有的表进行删除操作</span></span><br></pre></td></tr></table></figure>
<h4 id="1-11-限制返回的行数-rownum"><a href="#1-11-限制返回的行数-rownum" class="headerlink" title="1.11 限制返回的行数    rownum"></a>1.11 限制返回的行数    rownum</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tanle <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">2</span> ; 最多返回两行</span><br></pre></td></tr></table></figure>
<h4 id="1-12-从表中随机返回n条记录-dbms-random-value-获取随机数"><a href="#1-12-从表中随机返回n条记录-dbms-random-value-获取随机数" class="headerlink" title="1.12 从表中随机返回n条记录 dbms_random.value 获取随机数"></a>1.12 从表中随机返回n条记录 dbms_random.value 获取随机数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> A <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> dbms_random.value )</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">3</span> ;</span><br><span class="line">注意：先随机排序、再取返回行数</span><br><span class="line">错误写法如下：先取数据再随机排序 </span><br><span class="line"><span class="keyword">select</span> A <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">3</span>  <span class="keyword">order</span> <span class="keyword">by</span> dbms_random.value ;</span><br></pre></td></tr></table></figure>
<h4 id="1-13-模糊查询"><a href="#1-13-模糊查询" class="headerlink" title="1.13 模糊查询"></a>1.13 模糊查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">通配符：%(替代一个或多个字符) _ (替代一个或多个字符)</span><br><span class="line">常用方法：%%</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> A <span class="keyword">like</span> <span class="string">'%a%'</span>;</span><br><span class="line">转义字符 \</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> A <span class="keyword">like</span> <span class="string">'%\_%'</span> esacpe <span class="string">'\';</span></span><br><span class="line"><span class="string">转义\ 为 \\ 双斜杆 代表一个 \ 且作为通配符处理</span></span><br><span class="line"><span class="string">select * from table where A like '</span>%\\_%<span class="string">' esacpe '</span>\<span class="string">';</span></span><br></pre></td></tr></table></figure>
<h3 id="第二章：给查询结果排序"><a href="#第二章：给查询结果排序" class="headerlink" title="第二章：给查询结果排序"></a>第二章：给查询结果排序</h3><h4 id="2-1指定的次序返回查询额几个"><a href="#2-1指定的次序返回查询额几个" class="headerlink" title="2.1指定的次序返回查询额几个"></a>2.1指定的次序返回查询额几个</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> A,B,C <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> A <span class="keyword">asc</span>;	asc 按照小到大排序 desc 按照大到小排序</span><br><span class="line"><span class="keyword">select</span> A,B,C <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span> <span class="keyword">asc</span>;	排序结果以第一列【排序</span><br><span class="line">注意：数据替代列位置，只能用于order by</span><br></pre></td></tr></table></figure>
<h4 id="2-3-按字符排序"><a href="#2-3-按字符排序" class="headerlink" title="2.3 按字符排序"></a>2.3 按字符排序</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> A,B,C,<span class="keyword">substr</span>(A,<span class="number">-4</span>) <span class="keyword">as</span> 尾号 <span class="keyword">from</span> <span class="keyword">table</span>  <span class="keyword">where</span> <span class="keyword">rownum</span> &lt;= <span class="number">5</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">4</span> <span class="keyword">asc</span>;	</span><br><span class="line">通过截取出来的第四列尾号进行排序</span><br></pre></td></tr></table></figure>
<h4 id="2-4-translate-是replace的超集"><a href="#2-4-translate-是replace的超集" class="headerlink" title="2.4 translate  是replace的超集"></a>2.4 translate  是replace的超集</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语法：translate(expr , from_string , to_string)</span><br><span class="line">from_string 和 to_string 以字符串为单位，对应字符一一替换</span><br><span class="line">1、to_string 为空，返回空值</span><br><span class="line">2、to_string 对应的位置没有字符，删除from_string 中列出来的字符将会被消掉。！！</span><br></pre></td></tr></table></figure>
<h4 id="2-5-按数字和字母混合字符串中的字母排序-数字排序-使用translate-函数过滤不需要字符"><a href="#2-5-按数字和字母混合字符串中的字母排序-数字排序-使用translate-函数过滤不需要字符" class="headerlink" title="2.5 按数字和字母混合字符串中的字母排序(数字排序) 使用translate 函数过滤不需要字符"></a>2.5 按数字和字母混合字符串中的字母排序(数字排序) 使用translate 函数过滤不需要字符</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> A|| <span class="string">' '</span> || B  <span class="keyword">as</span> <span class="built_in">date</span> <span class="keyword">from</span> <span class="keyword">table</span> ;  //</span><br><span class="line">其中A 是数据 B 是字母</span><br><span class="line">查询结果为</span><br><span class="line">1234  kell</span><br><span class="line">123	 cat</span><br><span class="line">现在排序查询：</span><br><span class="line"><span class="keyword">select</span>  <span class="built_in">date</span> , <span class="keyword">translate</span>(<span class="built_in">date</span>,<span class="string">'- 0123456789'</span>,<span class="string">'-'</span>) <span class="keyword">as</span> date2 </span><br><span class="line"><span class="keyword">from</span> <span class="keyword">table</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> date2 ;</span><br><span class="line">把数字和空格转为空，利用2.4的第二点内容</span><br></pre></td></tr></table></figure>
<h4 id="2-6-处理排序空值"><a href="#2-6-处理排序空值" class="headerlink" title="2.6 处理排序空值"></a>2.6 处理排序空值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用 nvl(A, -1 ) 这种方式为空值赋值，需要对列的类型和保存数据有所了解，如果保存数据变化是，该语句需要维护，不太友好</span><br><span class="line">关键字 nulls first 空值在前 和 null last 空值在后</span><br><span class="line"><span class="keyword">select</span> A,B,C <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> <span class="keyword">nulls</span> <span class="keyword">first</span> ;</span><br><span class="line"><span class="keyword">select</span> A,B,C <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span> <span class="keyword">nulls</span> <span class="keyword">last</span>;</span><br></pre></td></tr></table></figure>
<h4 id="2-7根据条件取不同的列中的值来排序处理"><a href="#2-7根据条件取不同的列中的值来排序处理" class="headerlink" title="2.7根据条件取不同的列中的值来排序处理"></a>2.7根据条件取不同的列中的值来排序处理</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">通过新生一列，用多排序方式处理</span><br><span class="line"><span class="keyword">select</span> A,B,<span class="keyword">case</span> <span class="keyword">where</span> A &gt;=<span class="number">0</span> <span class="keyword">and</span> A &lt; <span class="number">5</span> <span class="keyword">then</span> a <span class="keyword">else</span> <span class="number">2</span> <span class="keyword">end</span> <span class="keyword">as</span> C,D </span><br><span class="line"><span class="keyword">from</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">where</span> D = <span class="string">'销售部'</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span>,<span class="number">4</span> ;</span><br><span class="line">不显示多一行，将case where 放到order by 后面</span><br><span class="line"><span class="keyword">select</span> A,B,D </span><br><span class="line"><span class="keyword">from</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">where</span> D = <span class="string">'销售部'</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">case</span> <span class="keyword">where</span> A &gt;=<span class="number">0</span> <span class="keyword">and</span> A &lt; <span class="number">5</span> <span class="keyword">then</span> a <span class="keyword">else</span> <span class="number">2</span> <span class="keyword">end</span> ,<span class="number">3</span> ;</span><br></pre></td></tr></table></figure>
<h3 id="第三章：操作多张表"><a href="#第三章：操作多张表" class="headerlink" title="第三章：操作多张表"></a>第三章：操作多张表</h3><h4 id="3-1-union-all-与空字符串"><a href="#3-1-union-all-与空字符串" class="headerlink" title="3.1 union all 与空字符串"></a>3.1 union all 与空字符串</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select A,B,C from table </span><br><span class="line">union all</span><br><span class="line">select A,B,&apos;&apos; as C from table_a</span><br><span class="line">其中第二个 ‘’ as c 相当于 NULL空字符串</span><br></pre></td></tr></table></figure>
<h4 id="3-2-union-与-or"><a href="#3-2-union-与-or" class="headerlink" title="3.2 union 与 or"></a>3.2 union 与 or</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//创建索引</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_empno <span class="keyword">on</span> emp(empo)</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_ename <span class="keyword">on</span> emp(ename)</span><br><span class="line"><span class="keyword">union</span> 和 <span class="keyword">union</span> <span class="keyword">all</span> 其中<span class="keyword">union</span> 去掉重复数据</span><br></pre></td></tr></table></figure>
<h4 id="3-4-in-exists-和-inner-join"><a href="#3-4-in-exists-和-inner-join" class="headerlink" title="3.4 in exists 和 inner join"></a>3.4 in exists 和 inner join</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">inner join  没有重复列时候可以直接使用</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> A <span class="keyword">in</span> (<span class="string">''</span>,<span class="string">''</span>)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> (A,B) <span class="keyword">in</span> (<span class="keyword">select</span> A,B <span class="keyword">from</span> table2) </span><br><span class="line"><span class="keyword">select</span> A,B,C <span class="keyword">from</span> <span class="keyword">table</span> a  <span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> A,B,C <span class="keyword">from</span> table2 b <span class="keyword">where</span> a.A= b.A )</span><br><span class="line"><span class="keyword">select</span> A,B,C <span class="keyword">from</span>  <span class="keyword">table</span> <span class="keyword">inner</span> <span class="keyword">join</span> table2 <span class="keyword">on</span> (a.A = b.A)</span><br><span class="line"><span class="keyword">select</span> A <span class="keyword">from</span> <span class="keyword">table</span> a,table2 b <span class="keyword">where</span> a.A= b.A</span><br></pre></td></tr></table></figure>
<h4 id="3-5-inner-join-内关联-、left-join-左关联-、right-join-右关联-和-full-join-外关联-全关联"><a href="#3-5-inner-join-内关联-、left-join-左关联-、right-join-右关联-和-full-join-外关联-全关联" class="headerlink" title="3.5 inner join 内关联 、left join 左关联 、right join 右关联 和 full join 外关联(全关联)"></a>3.5 inner join 内关联 、left join 左关联 、right join 右关联 和 full join 外关联(全关联)</h4><h4 id="3-6-自关联"><a href="#3-6-自关联" class="headerlink" title="3.6 自关联"></a>3.6 自关联</h4><h4 id="3-7-not-in-、-not-exists-和-left-join"><a href="#3-7-not-in-、-not-exists-和-left-join" class="headerlink" title="3.7 not in 、 not exists 和 left join"></a>3.7 not in 、 not exists 和 left join</h4><h4 id="3-8-外连接的条件不能乱放，否则就内部运行，不按照对应的方式查询"><a href="#3-8-外连接的条件不能乱放，否则就内部运行，不按照对应的方式查询" class="headerlink" title="3.8 外连接的条件不能乱放，否则就内部运行，不按照对应的方式查询"></a>3.8 外连接的条件不能乱放，否则就内部运行，不按照对应的方式查询</h4><h4 id="3-9-检测两个表中的数据及对应数据的条数相同-例子p45"><a href="#3-9-检测两个表中的数据及对应数据的条数相同-例子p45" class="headerlink" title="3.9 检测两个表中的数据及对应数据的条数相同 例子p45"></a>3.9 检测两个表中的数据及对应数据的条数相同 例子p45</h4><h4 id="3-10-聚集与内连接-p46"><a href="#3-10-聚集与内连接-p46" class="headerlink" title="3.10 聚集与内连接 p46"></a>3.10 聚集与内连接 p46</h4><h4 id="3-11-聚集与外连接-p50"><a href="#3-11-聚集与外连接-p50" class="headerlink" title="3.11 聚集与外连接 p50"></a>3.11 聚集与外连接 p50</h4><h4 id="3-12-从多个表中返回丢失的数据-p50"><a href="#3-12-从多个表中返回丢失的数据-p50" class="headerlink" title="3.12 从多个表中返回丢失的数据 p50"></a>3.12 从多个表中返回丢失的数据 p50</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过full jin 和 union all 方式显示，关联缺少数据</span><br></pre></td></tr></table></figure>
<h4 id="3-13-多表查询时的空值处理"><a href="#3-13-多表查询时的空值处理" class="headerlink" title="3.13 多表查询时的空值处理"></a>3.13 多表查询时的空值处理</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注意：与空值比较之后的值依旧为空值，需要转化之后才能比较 </span><br><span class="line">coalesce(a.comn,0)  如果为空则为0</span><br></pre></td></tr></table></figure>
<h3 id="第四章-插入更新与修改"><a href="#第四章-插入更新与修改" class="headerlink" title="第四章 插入更新与修改"></a>第四章 插入更新与修改</h3><h4 id="4-1-插入新纪录-p55"><a href="#4-1-插入新纪录-p55" class="headerlink" title="4.1 插入新纪录 p55"></a>4.1 插入新纪录 p55</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_a(</span><br><span class="line">a varchar2(<span class="number">10</span>) <span class="keyword">default</span> <span class="string">'默认值a'</span>,</span><br><span class="line">b varchar2(<span class="number">10</span>) <span class="keyword">default</span> <span class="string">'默认值b'</span>,</span><br><span class="line">c varchar2(<span class="number">10</span>) <span class="keyword">default</span> <span class="string">'默认值c'</span>,</span><br><span class="line">d <span class="keyword">data</span> <span class="keyword">default</span> <span class="keyword">sysdate</span>,</span><br><span class="line">e <span class="built_in">decimal</span> <span class="keyword">default</span> <span class="number">0</span></span><br><span class="line">);</span><br><span class="line">default 默认值</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_a (a,b,c) <span class="keyword">values</span> (<span class="string">'a'</span>,<span class="literal">null</span>,<span class="string">'c'</span>);</span><br></pre></td></tr></table></figure>
<h4 id="4-2-阻止对某列的插入-p56"><a href="#4-2-阻止对某列的插入-p56" class="headerlink" title="4.2 阻止对某列的插入 p56"></a>4.2 阻止对某列的插入 p56</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">创建一个view然后插入值，不过不能再使用default的默认属性了</span><br></pre></td></tr></table></figure>
<h4 id="4-3-复制表的定义及数据-p57"><a href="#4-3-复制表的定义及数据-p57" class="headerlink" title="4.3 复制表的定义及数据 p57"></a>4.3 复制表的定义及数据 p57</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a.复制表的定义及数据</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_b <span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> table_a;</span><br><span class="line">b.复制标的定义不包括数据,然后再自己新增数据</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_b <span class="keyword">as</span> <span class="keyword">select</span> * <span class="keyword">from</span> table_a wherer <span class="number">1</span>=<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h4 id="4-4-用-with-check-option-限制数据的录入-p57"><a href="#4-4-用-with-check-option-限制数据的录入-p57" class="headerlink" title="4.4 用 with check option 限制数据的录入 p57"></a>4.4 用 with check option 限制数据的录入 p57</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a.简单的直接添加到表结构内下 constraints  添加约束条件</span><br><span class="line">ps: <span class="keyword">alter</span> table_a <span class="keyword">add</span> <span class="keyword">constraints</span> ch_e <span class="keyword">check</span> (e &gt; <span class="number">0</span>); a必须大于0 才能插入</span><br><span class="line">b.复杂或特殊的约束条件是不能直接放到表内的如日期等</span><br><span class="line">ps: <span class="keyword">alter</span> table_a <span class="keyword">add</span> contraints ch_d checck ( d &gt;= <span class="keyword">sysdate</span> );</span><br><span class="line">错误提示：ora-02436:日期或者系统变量在<span class="keyword">check</span> 约束条件中指定错误</span><br><span class="line">c.with <span class="keyword">check</span> <span class="keyword">option</span> 使用</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_a </span><br><span class="line">(<span class="keyword">select</span> a,b,c,d <span class="keyword">from</span> table_a <span class="keyword">where</span> d &lt;= <span class="keyword">sysdate</span> <span class="keyword">with</span> <span class="keyword">check</span> <span class="keyword">option</span> ) <span class="keyword">values</span> (<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="keyword">sysdate</span>+<span class="number">1</span>);</span><br><span class="line">错误提示：ora-01402 视图<span class="keyword">with</span> <span class="keyword">check</span> <span class="keyword">option</span> <span class="keyword">where</span> 子句违规</span><br></pre></td></tr></table></figure>
<h4 id="4-5-多表插入语句-p58"><a href="#4-5-多表插入语句-p58" class="headerlink" title="4.5 多表插入语句 p58"></a>4.5 多表插入语句 p58</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">四种情况：</span><br><span class="line">a. 无条件 <span class="keyword">insert</span></span><br><span class="line">b. 有条件 <span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">c. 转置 <span class="keyword">insert</span></span><br><span class="line">d. 有条件 <span class="keyword">insert</span> <span class="keyword">first</span> </span><br><span class="line"></span><br><span class="line">a. 无条件的<span class="keyword">insert</span></span><br><span class="line">    创建两个测试表</span><br><span class="line">    <span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> table_b <span class="keyword">as</span> <span class="keyword">select</span>  a,b,c  <span class="keyword">from</span> table_a <span class="keyword">where</span> <span class="number">1</span>=<span class="number">2</span></span><br><span class="line">    <span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> table_c <span class="keyword">as</span> <span class="keyword">select</span>  a,b,e  <span class="keyword">from</span> table_a <span class="keyword">where</span> <span class="number">1</span>=<span class="number">2</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">into</span> table_b (a,b,c) <span class="keyword">values</span> (a,b,c)</span><br><span class="line">    <span class="keyword">into</span> table_c (a,b,e) <span class="keyword">values</span> (a,b,e)</span><br><span class="line">    <span class="keyword">select</span> a,b,c,e <span class="keyword">from</span> table_a <span class="keyword">where</span> a <span class="keyword">in</span> (<span class="string">'a_1'</span>,<span class="string">'a_2'</span>)</span><br><span class="line">    没有条件，所以table_b和table_c的条数一样</span><br><span class="line">b.有条件的<span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">delete</span> table_b;</span><br><span class="line">    delect table_c;</span><br><span class="line">    清空表table_b,table_c的数据</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">when</span> c <span class="keyword">in</span> (<span class="string">'c_1'</span>,<span class="string">'c-2'</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> table_b (a,b,c) <span class="keyword">values</span> (a,b,c)</span><br><span class="line">    <span class="keyword">when</span> e &gt; <span class="number">20</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> table_c (a,b,e) <span class="keyword">values</span> (a,b,e)</span><br><span class="line">    <span class="keyword">select</span> a,b,c,e <span class="keyword">from</span> table_a <span class="keyword">where</span> a <span class="keyword">in</span> (<span class="string">'a_1'</span>,<span class="string">'a_2'</span>)</span><br><span class="line">d. 有条件的 <span class="keyword">insert</span> frist </span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">first</span></span><br><span class="line">    <span class="keyword">when</span> c <span class="keyword">in</span> (<span class="string">'c_1'</span>,<span class="string">'c-2'</span>) <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> table_b (a,b,c) <span class="keyword">values</span> (a,b,c)</span><br><span class="line">    <span class="keyword">when</span> e &gt; <span class="number">20</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">into</span> table_c (a,b,e) <span class="keyword">values</span> (a,b,e)</span><br><span class="line">    <span class="keyword">select</span> a,b,c,e <span class="keyword">from</span> table_a <span class="keyword">where</span> a <span class="keyword">in</span> (<span class="string">'a_1'</span>,<span class="string">'a_2'</span>)</span><br><span class="line">    当符合第一个条件之后插入table_b，即使满足第二个条件也不会插入table_c内，这是和	</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">all</span> 和 <span class="keyword">insert</span> <span class="keyword">first</span> 区别所在</span><br><span class="line"></span><br><span class="line">e. 转置 <span class="keyword">insert</span> (以其一个分类，不然说是<span class="keyword">insert</span> <span class="keyword">all</span> 的一个用法)</span><br><span class="line">    将不同列的数据插入到同一张表的不同行内</span><br><span class="line">    <span class="keyword">drop</span> <span class="keyword">table</span> t1;</span><br><span class="line">    <span class="keyword">drop</span> <span class="keyword">table</span> t2;</span><br><span class="line">    <span class="keyword">create</span> <span class="keyword">table</span> t2 (d varchar2(<span class="number">10</span>), des varchar2(<span class="number">50</span>));</span><br><span class="line">    <span class="keyword">create</span> <span class="keyword">table</span> t1 <span class="keyword">as</span> </span><br><span class="line">    <span class="keyword">select</span> <span class="string">'熊1,精神不佳'</span> <span class="keyword">as</span> d1,</span><br><span class="line">    <span class="string">'熊2,精神不佳'</span> <span class="keyword">as</span> d2,</span><br><span class="line">    <span class="string">'熊3,精神不佳'</span> <span class="keyword">as</span> d3,</span><br><span class="line">    <span class="string">'熊4,精神不佳'</span> <span class="keyword">as</span> d4,</span><br><span class="line">    <span class="string">'熊5,精神不佳'</span> <span class="keyword">as</span> d5</span><br><span class="line">    <span class="keyword">from</span> dual;</span><br><span class="line">    <span class="comment">/*转置*/</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">into</span> t2(d,des) <span class="keyword">values</span> (<span class="string">'周1'</span>,d1)</span><br><span class="line">    <span class="keyword">into</span> t2(d,des) <span class="keyword">values</span> (<span class="string">'周2'</span>,d2)</span><br><span class="line">    <span class="keyword">into</span> t2(d,des) <span class="keyword">values</span> (<span class="string">'周3'</span>,d3)</span><br><span class="line">    <span class="keyword">into</span> t2(d,des) <span class="keyword">values</span> (<span class="string">'周4'</span>,d4)</span><br><span class="line">    <span class="keyword">into</span> t2(d,des) <span class="keyword">values</span> (<span class="string">'周5'</span>,d5)</span><br><span class="line">    <span class="keyword">select</span> d1,d2,d3,d4,d5 <span class="keyword">form</span> t1;</span><br><span class="line">    <span class="comment">/*结果*/</span></span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> t2</span><br><span class="line">    <span class="comment">-----------------------------------------------</span></span><br><span class="line">    周<span class="number">1</span> 熊<span class="number">1</span>，精神不佳</span><br><span class="line">    周<span class="number">2</span> 熊<span class="number">2</span>，精神不佳</span><br><span class="line">    周<span class="number">3</span> 熊<span class="number">3</span>，精神不佳</span><br><span class="line">    周<span class="number">4</span> 熊<span class="number">4</span>，精神不佳</span><br><span class="line">    周<span class="number">5</span> 熊<span class="number">5</span>，精神不佳</span><br><span class="line">    等价于<span class="keyword">sql</span>语句</span><br><span class="line">    <span class="keyword">insert</span> t2 (d,des)</span><br><span class="line">    <span class="keyword">select</span> <span class="string">'周1'</span>,d1 <span class="keyword">from</span> t1 <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> <span class="string">'周2'</span>,d2 <span class="keyword">from</span> t1 <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> <span class="string">'周3'</span>,d3 <span class="keyword">from</span> t1 <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> <span class="string">'周4'</span>,d4 <span class="keyword">from</span> t1 <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> <span class="string">'周5'</span>,d5 <span class="keyword">from</span> t1 ;</span><br></pre></td></tr></table></figure>
<h4 id="4-6-用其他表中的值更新-p63"><a href="#4-6-用其他表中的值更新-p63" class="headerlink" title="4.6 用其他表中的值更新 p63"></a>4.6 用其他表中的值更新 p63</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> table_a <span class="keyword">add</span> aname varchar2(<span class="number">50</span>) <span class="keyword">default</span> <span class="string">'noname'</span>;</span><br><span class="line">    添加上限制，否则全部更新，不符合更新条件的数据将会被设值为NULL</span><br><span class="line">    添加where exists() 获取需要更新的语句</span><br><span class="line"><span class="keyword">alter</span> table_a <span class="keyword">add</span> contraints pk_a primary <span class="keyword">key</span> (a) ; //添加主键</span><br><span class="line">    方式三种：直接关联、view 、<span class="keyword">merge</span>(只关联一个数据库)</span><br><span class="line"><span class="keyword">merge</span> <span class="keyword">into</span> emp</span><br><span class="line">    <span class="keyword">using</span>( <span class="keyword">select</span> dname,deptno <span class="keyword">from</span> dept <span class="keyword">where</span> depy.name <span class="keyword">in</span> (<span class="string">'a'</span>,<span class="string">'b'</span>) ) dept</span><br><span class="line">    <span class="keyword">on</span> (dept.deptno = emp.deptno )</span><br><span class="line">    <span class="keyword">when</span> <span class="keyword">matched</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">update</span> <span class="keyword">set</span> emp.dname = dept.dname;</span><br></pre></td></tr></table></figure>
<h4 id="4-7-合并记录-p67-merge-into-重点方式和详细使用，可同时操作增删改进行"><a href="#4-7-合并记录-p67-merge-into-重点方式和详细使用，可同时操作增删改进行" class="headerlink" title="4.7 合并记录 p67 *** merge into  重点方式和详细使用，可同时操作增删改进行"></a>4.7 合并记录 p67 *** merge into  重点方式和详细使用，可同时操作增删改进行</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">merge</span> <span class="keyword">into</span> table_a  a</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">select</span> a,b <span class="keyword">from</span> table_b <span class="keyword">where</span> a = <span class="string">'good'</span>) b <span class="keyword">on</span> (b,a = a.a)</span><br><span class="line">    <span class="keyword">when</span> matchtd <span class="keyword">then</span> //满足条件</span><br><span class="line">    <span class="keyword">update</span> <span class="keyword">set</span> a.a= a.a + b.b;</span><br><span class="line">    delect where ()</span><br><span class="line">    when not matched then //不满足条件的</span><br><span class="line">    <span class="keyword">insert</span> (a.a) <span class="keyword">values</span> (b.b)</span><br><span class="line">    <span class="keyword">where</span> b.c &lt; =<span class="number">800</span> ;</span><br></pre></td></tr></table></figure>
<h4 id="4-8-删除违反参照完整性的记录-p71"><a href="#4-8-删除违反参照完整性的记录-p71" class="headerlink" title="4.8 删除违反参照完整性的记录 p71"></a>4.8 删除违反参照完整性的记录 p71</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_a <span class="keyword">add</span> contraints pk_a primary <span class="keyword">key</span> (a) //主键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> table_b <span class="keyword">add</span> contraints fk_b_a <span class="keyword">foreign</span> <span class="keyword">key</span> (a) <span class="keyword">references</span> table_a(a) //外检</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_a,b <span class="keyword">on</span> table_a(a,b) //索引</span><br></pre></td></tr></table></figure>
<h4 id="4-9-删除名称重复的记录-p72"><a href="#4-9-删除名称重复的记录-p72" class="headerlink" title="4.9 删除名称重复的记录 p72"></a>4.9 删除名称重复的记录 p72</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.通过字段判断（建立索引加快效率）</span><br><span class="line">    <span class="keyword">create</span> <span class="keyword">index</span> idx_a,b <span class="keyword">on</span> table_a(a,b) //索引</span><br><span class="line"><span class="number">2.</span>通过<span class="keyword">rowid</span>判断</span><br><span class="line"><span class="number">3.</span>通过分组序号判断</span><br><span class="line">    row_number() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> <span class="keyword">name</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span>) <span class="keyword">as</span> sep 通过名称，<span class="keyword">ID</span>排序获取行号</span><br></pre></td></tr></table></figure>
<h3 id="第五章、使用字符串"><a href="#第五章、使用字符串" class="headerlink" title="第五章、使用字符串"></a>第五章、使用字符串</h3><h4 id="5-1-遍历字符串"><a href="#5-1-遍历字符串" class="headerlink" title="5.1 遍历字符串"></a>5.1 遍历字符串</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">level</span> <span class="keyword">form</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="number">4</span> </span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> 是一种树形查询的一个子句返回的值是伪列，表示树形中的级别层次</span><br><span class="line">例子：</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">view</span> v <span class="keyword">as</span> </span><br><span class="line"><span class="keyword">select</span> <span class="string">"天天向上"</span> <span class="keyword">as</span> 汉字,<span class="string">'TTXS'</span> <span class="keyword">as</span> 拼音 <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> v.拼音,</span><br><span class="line">v.汉字,</span><br><span class="line"><span class="keyword">level</span>,</span><br><span class="line"><span class="keyword">substr</span>(v.汉字,<span class="keyword">level</span>,<span class="number">1</span>) <span class="keyword">as</span> 拆分汉字,</span><br><span class="line"><span class="keyword">substr</span>(v.拼音,<span class="keyword">level</span>,<span class="number">1</span>) <span class="keyword">as</span> 拆分拼音</span><br><span class="line"><span class="keyword">from</span> v <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">length</span>(v.汉字);</span><br></pre></td></tr></table></figure>
<h4 id="5-2-字符串文字包含引号"><a href="#5-2-字符串文字包含引号" class="headerlink" title="5.2 字符串文字包含引号"></a>5.2 字符串文字包含引号</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">oracle 10g 新增了 q_quote 特性 定界符 q'[132]' </span><br><span class="line">界定符可以是‘’,[],()&lt;&gt; ，而且必须成对存在</span><br><span class="line">开头是Q或者q，后面加定位符,中间放内容</span><br><span class="line"> 5.3 计算字符在字符串中出现的次数</span><br><span class="line">1.计算子字符串个数，分隔符字符串是一个</span><br><span class="line">    a. oracle 11g 提供函数 regexp_count 计算出现次数</span><br><span class="line">        <span class="keyword">select</span> regexp_count(<span class="keyword">str</span>,<span class="string">','</span>) + <span class="number">1</span>  <span class="keyword">from</span> dual;</span><br><span class="line">        <span class="keyword">select</span> regexp_count(<span class="string">'qwe,qeqew,qeqe'</span>,<span class="string">','</span>) + <span class="number">1</span>  <span class="keyword">from</span> dual; //获取字符串个数</span><br><span class="line">    b. 没有regexp_count 函数则用regexp_replace 迂回求值即可</span><br><span class="line">        <span class="keyword">select</span> <span class="keyword">length</span>(regexp_replace(<span class="keyword">str</span>,<span class="string">'[^,]'</span>)) + <span class="number">1</span>  <span class="keyword">from</span> dual; </span><br><span class="line">        <span class="keyword">select</span> <span class="keyword">length</span>(regexp_replace(<span class="string">'字,符,串'</span>,<span class="string">'[^,]'</span>)) + <span class="number">1</span>  <span class="keyword">from</span> dual;  //返回三</span><br><span class="line">    c. 还可以使用translate()</span><br><span class="line">        <span class="keyword">select</span> <span class="keyword">length</span>(<span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">','</span>||<span class="keyword">str</span>,<span class="string">','</span>) +<span class="number">1</span> <span class="keyword">from</span> dual;</span><br><span class="line">        <span class="keyword">select</span> <span class="keyword">length</span>(<span class="keyword">translate</span>(<span class="string">'字,符,串'</span>,<span class="string">','</span>||<span class="string">'字,符,串'</span>,<span class="string">','</span>)) +<span class="number">1</span> <span class="keyword">from</span> dual;</span><br><span class="line">2.分隔符号是多个时候,如分隔字符为‘S<span class="comment">#’</span></span><br><span class="line">    //需要考虑分隔符长度问题</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">length</span>(<span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">'S#'</span> || <span class="keyword">str</span> ,<span class="string">'S#'</span>)) / <span class="keyword">length</span>(<span class="string">'S#'</span>) +<span class="number">1</span> <span class="keyword">as</span> cnt <span class="keyword">from</span> dual;</span><br><span class="line">    <span class="keyword">select</span> regexp_count(<span class="keyword">str</span>,<span class="string">'S#'</span>) + <span class="number">1</span>  <span class="keyword">from</span> dual; //regexp_count 不需要考虑长度问题</span><br></pre></td></tr></table></figure>
<h4 id="5-4-从字符串中删除不需要的字符串"><a href="#5-4-从字符串中删除不需要的字符串" class="headerlink" title="5.4 从字符串中删除不需要的字符串"></a>5.4 从字符串中删除不需要的字符串</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">例子：将名字中的元音字符 aeiou 去掉</span><br><span class="line">1. <span class="keyword">select</span> <span class="keyword">replace</span>(<span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">'aeiou'</span>,<span class="string">'aaaaa'</span>),<span class="string">'a'</span>,<span class="string">''</span>) <span class="keyword">from</span> dual; 将元音转换为a之后在替换为‘’</span><br><span class="line">2. <span class="keyword">select</span> <span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">'1aeiou'</span>,<span class="string">'1'</span>)  <span class="keyword">from</span> dual;</span><br><span class="line">3.正则表达式替换 regexp_replace,相当于执行多个<span class="keyword">replace</span>方式</span><br><span class="line">    <span class="keyword">select</span> regexp_replace(<span class="keyword">str</span>,<span class="string">'[aeiou]'</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-5-将字符和数字数据分隔-regexp-replace"><a href="#5-5-将字符和数字数据分隔-regexp-replace" class="headerlink" title="5.5 将字符和数字数据分隔 regexp_replace"></a>5.5 将字符和数字数据分隔 regexp_replace</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">使用正则表达式 ^否意思 如果不放在方括号内且开头，如 ^hell 默认字符串开始位置</span><br><span class="line">    <span class="keyword">select</span> regexp_replace(<span class="keyword">str</span>,<span class="string">'[0-9]'</span>,<span class="string">''</span>) , regexp_replace(<span class="keyword">str</span>,<span class="string">'[^0-9]'</span>,<span class="string">''</span>) <span class="keyword">from</span> dual ;</span><br><span class="line">ps：<span class="keyword">select</span> regexp_replace(<span class="string">'1asd123'</span>,<span class="string">'[0-9]'</span>,<span class="string">''</span>) ,regexp_replace(<span class="string">'1asd123'</span>,<span class="string">'[^0-9]'</span>,<span class="string">''</span>) <span class="keyword">from</span> dual ;   </span><br><span class="line">结果 asd 1123</span><br><span class="line">下面translate 达到相同的效果</span><br><span class="line">ps: <span class="keyword">select</span> <span class="keyword">translate</span>(<span class="string">'1asd123'</span>,<span class="string">'a0123456789'</span>,<span class="string">'a'</span>) <span class="keyword">as</span> 非数字,  <span class="keyword">translate</span>(<span class="string">'1asd123'</span>,<span class="string">'0123456789'</span>||<span class="string">'1asd123'</span> ,<span class="string">'0123456789'</span>) <span class="keyword">as</span> 数字 <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-6-查询只包含字母或数字型的数据"><a href="#5-6-查询只包含字母或数字型的数据" class="headerlink" title="5.6 查询只包含字母或数字型的数据"></a>5.6 查询只包含字母或数字型的数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">正则表达式一些小知识</span><br><span class="line">regexp_count 统计数量 regexp_replace 替换 regexp_like 模糊查询</span><br><span class="line">[^] ^ 代表否定 ^str  代表字符串的开始位置</span><br><span class="line">    regexp_like(str,'a') like ''%a% </span><br><span class="line">    regexp_like(str,'^a') like 'a%'  没有前模糊查询</span><br><span class="line">    regexp_like(str,'a$') like '%a'  没有后模糊查询</span><br><span class="line">    regexp_like(str,’^a$') like 'a'  精确查询	</span><br><span class="line">+ 和 * ‘+’ 表示匹配前面的表达式一次或多次：‘*’ 表示匹配前面的表达式零或多次</span><br><span class="line">regexp_like(str,'16+') like '16%'</span><br><span class="line">regexp_like(str,'16*') like '1%'</span><br><span class="line">注意：NULL 是不能用like来比较的</span><br></pre></td></tr></table></figure>
<h4 id="5-7-提取姓名的大写首字母缩写"><a href="#5-7-提取姓名的大写首字母缩写" class="headerlink" title="5.7 提取姓名的大写首字母缩写"></a>5.7 提取姓名的大写首字母缩写</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">正则表达式实现</span><br><span class="line">    <span class="keyword">select</span> regexp_replace(<span class="keyword">str</span>,<span class="string">'([[:upper:]])(.*)([[:upper:]])(.*)'</span>,<span class="string">'\1.\3'</span>) <span class="keyword">from</span> dual;</span><br><span class="line">    <span class="keyword">select</span> regexp_replace(<span class="string">'Hello World'</span>,<span class="string">'([[:upper:]])(.*)([[:upper:]])(.*)'</span>,<span class="string">'\1.\3'</span>) <span class="keyword">from</span> dual;</span><br><span class="line">    <span class="keyword">select</span> regexp_replace(<span class="string">'Hello World Gong'</span>,<span class="string">'([[:upper:]])(.*)([[:upper:]])(.*)([[:upper:]])(.*)'</span>,<span class="string">'\1.\3.\5'</span>) <span class="keyword">from</span> dual;</span><br><span class="line">()()()()将字符串分隔四部分，\1.\3 分别取13部分，中间加‘.’符号</span><br><span class="line">translate 方式替换更加简洁</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">' '</span>|| <span class="keyword">lower</span>(<span class="keyword">str</span>),<span class="string">'.'</span>) <span class="keyword">from</span> dual;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">translate</span>(<span class="string">'Hello World Gong'</span>,<span class="string">' '</span>|| <span class="keyword">lower</span>(<span class="string">'Hello World Gong'</span>),<span class="string">'.'</span>) <span class="keyword">from</span> dual;</span><br><span class="line">先将字符串转小写，然后空格替换为’.‘ 结果保留大写字母</span><br></pre></td></tr></table></figure>
<h4 id="5-8-按字符串中的数值排序"><a href="#5-8-按字符串中的数值排序" class="headerlink" title="5.8 按字符串中的数值排序"></a>5.8 按字符串中的数值排序</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">可以通过正则表达式和translate 方式新增一列清空非数字列，排序</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">str</span>,to_number(regexp_replace(<span class="keyword">str</span>,<span class="string">'[^0-9]'</span>,<span class="string">''</span>) ) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">order</span> <span class="keyword">by</span> str2;</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">str</span>,to_number(<span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">'0123456789'</span>|| <span class="keyword">str</span>,<span class="string">'0123456789'</span>) ) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">order</span> <span class="keyword">by</span> str2;</span><br><span class="line">ps:例子</span><br><span class="line">    <span class="keyword">select</span> <span class="string">'asdfasdf12'</span>,to_number(regexp_replace(<span class="string">'asdfasdf12'</span>,<span class="string">'[^0-9]'</span>,<span class="string">''</span>) ) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">order</span> <span class="keyword">by</span> str2;</span><br><span class="line">    <span class="keyword">select</span>  <span class="string">'asdfasdf12'</span>,to_number(<span class="keyword">translate</span>( <span class="string">'asdfasdf12'</span>,<span class="string">'0123456789'</span>||  <span class="string">'asdfasdf12'</span>,<span class="string">'0123456789'</span>) ) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">order</span> <span class="keyword">by</span> str2;</span><br></pre></td></tr></table></figure>
<h4 id="5-9-根据表中的行创建一个分隔列表"><a href="#5-9-根据表中的行创建一个分隔列表" class="headerlink" title="5.9 根据表中的行创建一个分隔列表"></a>5.9 根据表中的行创建一个分隔列表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wmsys.wm_concat 函数 具有不确定性 返回varcahr,但是在oracl 11.2 返回的是clob类型</span><br><span class="line">oracl 11.2 开始有分析函数 listagg </span><br><span class="line">    <span class="keyword">select</span>  deptno,sun(sal) <span class="keyword">as</span> total_sal,</span><br><span class="line">    <span class="keyword">listagg</span>(ename,<span class="string">','</span>) <span class="keyword">with</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> ename ) <span class="keyword">as</span> tomal_name</span><br></pre></td></tr></table></figure>
<p>  from emp order by deptno;</p>
<h4 id="5-10-提取第N个分隔字符串"><a href="#5-10-提取第N个分隔字符串" class="headerlink" title="5.10 提取第N个分隔字符串"></a>5.10 提取第N个分隔字符串</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">正则表达式 regexp_substr </span><br><span class="line">    <span class="keyword">select</span> regexp_substr(<span class="keyword">str</span>,<span class="string">'[^,]+'</span>,<span class="number">1</span>,<span class="number">2</span>) <span class="keyword">as</span> 子字符串 <span class="keyword">from</span> dual;</span><br><span class="line">    <span class="keyword">select</span> regexp_substr(<span class="string">'aa,b,ac,ad,'</span>,<span class="string">'[^,]+'</span>,<span class="number">1</span>,<span class="number">4</span>) <span class="keyword">as</span> 子字符串 <span class="keyword">from</span> dual;  //最后一个参数是返回第四个字符串</span><br></pre></td></tr></table></figure>
<h4 id="5-11-分隔ip地址"><a href="#5-11-分隔ip地址" class="headerlink" title="5.11 分隔ip地址"></a>5.11 分隔ip地址</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> regexp_substr(<span class="keyword">str</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">as</span> ip1, </span><br><span class="line">    regexp_substr(<span class="keyword">str</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">2</span>) <span class="keyword">as</span> ip2, </span><br><span class="line">    regexp_substr(<span class="keyword">str</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">3</span>) <span class="keyword">as</span> ip3, </span><br><span class="line">    regexp_substr(<span class="keyword">str</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">4</span>) <span class="keyword">as</span> ip4</span><br><span class="line">    <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> regexp_substr(<span class="string">'192.168.1.1'</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">as</span> ip1, </span><br><span class="line">    regexp_substr(<span class="string">'192.168.1.1'</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">2</span>) <span class="keyword">as</span> ip2, </span><br><span class="line">    regexp_substr(<span class="string">'192.168.1.1'</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">3</span>) <span class="keyword">as</span> ip3, </span><br><span class="line">    regexp_substr(<span class="string">'192.168.1.1'</span>,<span class="string">'[^.]+'</span>,<span class="number">1</span>,<span class="number">4</span>) <span class="keyword">as</span> ip4</span><br><span class="line">    <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>
<h4 id="5-12-将分隔数据转换为多值in列表"><a href="#5-12-将分隔数据转换为多值in列表" class="headerlink" title="5.12 将分隔数据转换为多值in列表"></a>5.12 将分隔数据转换为多值in列表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">regexp_substr 和 translate 结合 转换为 in 条件入参</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">in</span> ( <span class="keyword">select</span> regexp_substr(<span class="keyword">str</span>, <span class="string">'[^,]+'</span>, <span class="number">1</span>, <span class="keyword">level</span>) <span class="keyword">as</span> ename  <span class="keyword">from</span>   dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= (<span class="keyword">length</span>(<span class="keyword">translate</span>(<span class="keyword">str</span>,<span class="string">','</span> || <span class="keyword">str</span> ,<span class="string">','</span>)) + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">in</span> ( <span class="keyword">select</span> regexp_substr(<span class="keyword">str</span>, <span class="string">'[^,]+'</span>, <span class="number">1</span>, <span class="keyword">level</span>) <span class="keyword">as</span> ename <span class="keyword">from</span>   dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= (regexp_count(<span class="keyword">str</span>,<span class="string">','</span>) + <span class="number">1</span>));</span><br></pre></td></tr></table></figure>
<h4 id="5-13-按照字母顺序排序字符串"><a href="#5-13-按照字母顺序排序字符串" class="headerlink" title="5.13 按照字母顺序排序字符串"></a>5.13 按照字母顺序排序字符串</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">通过拆分字符串+ listagg 合并显示结果</span><br><span class="line">1.拆分</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">str</span>,<span class="keyword">substr</span>(<span class="keyword">str</span>,<span class="keyword">level</span>,<span class="number">1</span>) <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">lenght</span>(<span class="keyword">str</span>) ;</span><br><span class="line">    ps: <span class="keyword">select</span> <span class="string">'fdavs'</span>,<span class="keyword">substr</span>( <span class="string">'fdavs'</span>,<span class="keyword">level</span>,<span class="number">1</span>) <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">length</span>( <span class="string">'fdavs'</span>) ;</span><br><span class="line">2.listagg 合并</span><br><span class="line">    <span class="keyword">select</span>  <span class="keyword">str</span>,<span class="keyword">listagg</span>(<span class="keyword">substr</span>(<span class="keyword">str</span>,<span class="keyword">level</span>,<span class="number">1</span>)) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">substr</span>(<span class="keyword">str</span>,<span class="keyword">level</span>,<span class="number">1</span>) ) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">length</span>(<span class="keyword">str</span>) <span class="keyword">order</span> <span class="keyword">by</span> str2;</span><br><span class="line">    ps : <span class="keyword">select</span>  <span class="string">'fdavs'</span>,<span class="keyword">listagg</span>(<span class="keyword">substr</span>(<span class="string">'fdavs'</span>,<span class="keyword">level</span>,<span class="number">1</span>)) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">substr</span>(<span class="string">'fdavs'</span>,<span class="keyword">level</span>,<span class="number">1</span>) ) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">length</span>(<span class="string">'fdavs'</span>) <span class="keyword">order</span> <span class="keyword">by</span> str2;</span><br><span class="line">3去重复</span><br><span class="line">    <span class="keyword">select</span>  <span class="keyword">listagg</span>(<span class="keyword">MIN</span>(<span class="keyword">substr</span>(<span class="string">'fdaaavs'</span>,<span class="keyword">level</span>,<span class="number">1</span>))) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">MIN</span>(<span class="keyword">substr</span>(<span class="string">'fdaaavs'</span>,<span class="keyword">level</span>,<span class="number">1</span>))) <span class="keyword">as</span> str2 <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> <span class="keyword">level</span> &lt;= <span class="keyword">length</span>(<span class="string">'fdaaavs'</span>)  <span class="keyword">group</span> <span class="keyword">by</span>  (<span class="keyword">substr</span>(<span class="string">'fdaaavs'</span>,<span class="keyword">level</span>,<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h4 id="5-14-判别可作为数值的字符串"><a href="#5-14-判别可作为数值的字符串" class="headerlink" title="5.14 判别可作为数值的字符串"></a>5.14 判别可作为数值的字符串</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpad 填充</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">substr</span>(<span class="string">'AAA-BBB'</span>,<span class="number">1</span>,<span class="keyword">instr</span>(<span class="string">'AAA-BBB'</span>,<span class="string">'-'</span>,<span class="number">-1</span>)<span class="number">-1</span>) 值 <span class="keyword">from</span> dual; 结果 AAA</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">substr</span>(<span class="string">'AAA-BBB'</span>,<span class="keyword">instr</span>(<span class="string">'AAA-BBB'</span>,<span class="string">'-'</span>,<span class="number">-1</span>)+<span class="number">1</span>) 值 <span class="keyword">from</span> dual; 结果 BBB</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/Oracl/">Oracl</a></div><div class="post-nav"><a class="pre" href="/2018/10/29/最小可行化产品MVP/">MVP——最小可行化产品</a><a class="next" href="/2017/05/26/hello-world/">Hello World</a></div></span></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Net-Core/">.Net Core</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web前端/">web前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/学习笔记/">学习笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/测试/" style="font-size: 15px;">测试</a> <a href="/tags/产品/" style="font-size: 15px;">产品</a> <a href="/tags/MVP/" style="font-size: 15px;">MVP</a> <a href="/tags/最小可行化/" style="font-size: 15px;">最小可行化</a> <a href="/tags/最简可行/" style="font-size: 15px;">最简可行</a> <a href="/tags/入门/" style="font-size: 15px;">入门</a> <a href="/tags/Oracl/" style="font-size: 15px;">Oracl</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/01/dotnet-Core-Web应用之Razor/">dotnet Core Web应用之Razor</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/26/NetCore的入门认识/">.NetCore的入门认识和创建</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/29/最小可行化产品MVP/">MVP——最小可行化产品</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/10/《Orale查询优化改写》读后笔记/">《Orale查询优化改》读后笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/26/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://blog.wayneshao.com/" title="玮仔Wayne" target="_blank">玮仔Wayne</a><ul></ul><a href="https://blog.chcaty.cn/" title="小猫" target="_blank">小猫</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">羽梦涟漪.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.7" zindex="1" count="150" src="//lib.baomitu.com/canvas-nest.js/2.0.3/canvas-nest.umd.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>